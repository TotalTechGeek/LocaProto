/*! 
 * LocaProto
 * 
 * Copyright 2018, Jesse Daniel Mitchell
 * Released under the MIT license.
 *
 * Date: 2018-01-30T23:26:54.214Z
 */
var LocaProto={};LocaProto.listened=[],LocaProto._channels={},LocaProto.broadcast="undefined"!=typeof BroadcastChannel,LocaProto._random=function(){return(1e9*Math.random()).toString(36).replace(/\./g,"")},LocaProto.fromQueryString=function(a){function b(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}return a?()=>b(a):location.search.substring(1)},LocaProto.cancel=LocaProto.clear=function(){LocaProto.listened.forEach((a)=>clearInterval(a)),LocaProto.listened.splice(0)},LocaProto._init=function(a){"undefined"!=typeof a&&(Array.isArray(a)?a.forEach((a)=>a(LocaProto.id)):a(LocaProto.id))},LocaProto.master=function(a){LocaProto.id=LocaProto._random(),LocaProto._init(a)},LocaProto.slave=function(a,b){LocaProto.id=a&&"function"==typeof a?a():window.location.hash.substring(1),LocaProto._init(b)},LocaProto.on=function(a,b){a=LocaProto.id+"-"+a,LocaProto.broadcast?function(a,b){let c=new BroadcastChannel(a);LocaProto._channels[a]=c,c.onmessage=(a)=>b(JSON.parse(a.data))}(a,b):function(a,b){LocaProto.listened.push(setInterval(function(){localStorage[a]&&(b(JSON.parse(localStorage[a])),localStorage.removeItem(a))},250))}(a,b)},LocaProto.send=function(a,b){a=LocaProto.id+"-"+a,LocaProto.broadcast?(!LocaProto._channels[a]&&(LocaProto._channels[a]=new BroadcastChannel(a)),LocaProto._channels[a].postMessage(JSON.stringify(b))):localStorage[a]=JSON.stringify(b)};
